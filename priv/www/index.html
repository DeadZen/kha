<!doctype html>
<html ng-app="Kha">
  <head>
    <script src="http://code.angularjs.org/1.0.1/angular-1.0.1.js"></script>
    <script src="http://code.angularjs.org/1.0.1/angular-resource-1.0.1.js"></script>
    <script src="http://documentcloud.github.com/underscore/underscore-min.js"></script>
    <script src="js/app.js"></script>
    <link type="text/css" rel="stylesheet" href="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.0.4/css/bootstrap-combined.min.css">
    <link type="text/css" rel="stylesheet" href="/css/kha.css">
  </head>
  <body>
    <div class="row" ng-controller="ProjectCtrl">
      <div class="span3">
        <h2>Projects</h2>
        <ul class="nav nav-tabs nav-stacked">
          <li ng:class="getClass(project.id)" ng-repeat="project in projects">
            <a ng-click="setCurrentProject(project.id)">
              <span>{{project.id}}</span> -
              <span>{{project.name}}</span>
            </a>
          </li>
        </ul>
      </div>

      <div class="span9">
        <h3>Project "{{projects[currentProject].name}}"</h3>
        <ul class="nav nav-tabs">
          <li ng:class="getTabClass('details')">
            <a ng-click="tab='details'" href="#">Details</a></li>
          <li ng:class="getTabClass('builds')">
            <a ng-click="tab='builds'" href="#">Builds</a></li>
          <li ng:class="getTabClass('build-details')">
            <a href="#">Build details</a></li>
        </ul>
        <div class="details" ng:show="tab == 'details'">
          <ul>
            <li>
              Local: <span>{{projects[currentProject].local}}</span>
            </li>
            <li>
              Remote: <span>{{projects[currentProject].remote}}</span>
            </li>
            <li>
              Build: <span>{{projects[currentProject].build}}</span>
            </li>
            <li>
              Notifications: <span>{{projects[currentProject].notifications}}</span>
            </li>
          </ul>
        </div>
        <div class="builds" ng-controller="BuildCtrl" ng:show="tab == 'builds'">
          <h5>Total builds: {{getTotalBuilds()}}</h5>
          <table class="table table-condensed">
            <tr ng-repeat="build in builds | orderBy:predicate:true"
                class="build-{{build.status}} build-row" ng-click="showBuildDetails(build)">
              <td>{{build.id}}</td>
              <td>{{build.status}}</td>
              <td>{{build.branch}}</td>
              <td>{{build.title}}</td>
              <td>{{build.author}}</td>
              <td>{{build.start}}</td>
              <td>{{build.stop}}</td>
              <td>
                <button class="btn" ng-click="rerun(build, $event)"><i class="icon-play"></i>Rerun</button>
                <button class="btn" ng-click="delete(build, $event)"><i class="icon-trash"></i>Delete</button>
              </td>
            </tr>
          </table>
        </div>
        <div class="build-details" ng:show="tab == 'build-details'">
          <pre>
            {{printBuildDetails(currentBuild)}}
          </pre>
        </div>
      </div>
    </div>
  </body>
</html>
